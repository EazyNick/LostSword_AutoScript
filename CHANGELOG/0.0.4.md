## [0.0.4] - 2025-12-14

### 추가됨
- **노드 출력 표준 형식**: 모든 노드의 출력을 `{action, status, output: {...}}` 형식으로 통일
  - `output` 필드는 반드시 dict 형식이며, 각 키가 프론트엔드에서 변수로 표시됨
  - n8n 스타일의 변수 선택 시스템 도입
- **노드 출력 파서 유틸리티**: `UI/src/pages/workflow/utils/node-output-parser.js` 추가
  - `extractOutputVariables()`: 노드 실행 결과에서 output 변수 목록 추출
  - `getNodeResult()`: 노드 데이터에서 실행 결과 가져오기
  - `collectPreviousNodeVariables()`: 이전 노드들의 출력 변수 목록 수집
- **data와 metadata 분리**: 노드 출력에서 실제 데이터와 메타데이터를 분리하여 처리
  - `output.data`: 실제 출력 데이터 (키-값 쌍)
  - `output.metadata`: 메타데이터 (id, x, y, createdAt, updatedAt 등)
- **대시보드 DB 구현**: 대시보드 통계를 데이터베이스에서 계산 및 저장
  - `calculate_and_update_dashboard_stats()`: 대시보드 통계 계산 및 업데이트
  - 스크립트 실행 기록 저장 기능 (`recordScriptExecution`)
  - 전체 실행 요약 정보 저장 기능 (`recordExecutionSummary`)
- **대시보드 실행 상태 관리**: 스크립트 실행 상태를 실시간으로 표시
  - 실행 중인 스크립트 표시
  - 실행 성공/실패 상태 표시
  - 이벤트 기반 상태 업데이트
- **노드 출력 표준 문서**: `docs/dev/node-output-standard.md` 추가
  - 표준 출력 형식 명세
  - 노드 구현 가이드
  - 마이그레이션 가이드
- **대시보드 문서**: `docs/dev/dashboard.md` 추가
  - 대시보드 기능 설명
  - API 엔드포인트 문서
  - 사용법 가이드
- **노드 실행 로그 시스템**: 각 노드 실행 시 자동으로 로그 수집 및 저장
  - `node_execution_logs` 테이블: 노드 실행 결과 추적
  - `NodeExecutionLogRepository`: 로그 관련 데이터베이스 작업 처리
  - 로그 수집 API (`POST /api/logs/node-execution`): 노드 실행 시 자동 호출
  - 로그 조회 API (`GET /api/logs/node-execution`): 다양한 필터 옵션 지원
  - 실패 로그 조회 API (`GET /api/logs/node-execution/failed`)
  - 로그 삭제 API (`DELETE /api/logs/node-execution/*`): 개별/실행 그룹/전체 삭제
- **실행 ID 생성 시스템**: 날짜시간 기반의 읽기 쉬운 실행 ID 생성 (`YYYYMMDD-HHMMSS-{랜덤}`)
- **실행 기록 페이지**: 노드 실행 로그를 시각적으로 조회 및 관리
  - 실행 그룹별 로그 표시 (실행 ID별 그룹화)
  - 필터링 기능 (스크립트별, 상태별)
  - 통계 카드 (전체/완료/실패 개수, 평균 실행 시간)
  - 로그 삭제 기능 (전체/실행 그룹/개별 삭제)
  - 다크/라이트 모드 지원
  - 실시간 로그 업데이트: 워크플로우 실행 완료 시 자동으로 로그 새로고침
- **로그 클라이언트 유틸리티**: 비동기 로그 전송 (`LogClient`)
- **프론트엔드 로그 API 클라이언트**: `LogAPI` 모듈
- **로그 서비스 계층**: `LogService` 클래스 (데이터 로드 및 통계 계산)
- **실행 기록 페이지 관리자**: `HistoryManager` 클래스
- **로그 관련 문서**: `docs/db/node_execution_logs.md` (아키텍처, API, 사용법 포함)
- **파라미터 기반 노드 설정 시스템**: `nodes_config.py`에서 노드의 동적 파라미터를 정의할 수 있는 `parameters` 필드 추가
- **동적 폼 생성**: `parameter-form-generator.js`를 통해 파라미터 정의에 따라 자동으로 UI 폼 생성
- **파일/폴더 선택 기능**: `folder_path`, `file_path` 파라미터에 자동으로 파일/폴더 선택 버튼 추가
- **파일 선택 API**: `/api/file/select` 엔드포인트 추가 (로컬 파일 선택 다이얼로그)
- **노드 필터링**: `nodes_config.py`에 정의되지 않은 노드는 DB에서 조회되지 않고 프론트엔드로 전송되지 않음
- **노드 생성/수정 모달 개선**: 파라미터 기반으로 동적으로 폼 생성 및 값 추출
- **노드 예시 출력 분리**: 노드 타입별 예시 출력을 `node-preview-outputs.js` 파일로 분리하여 관리

### 변경됨
- **결과 포맷터 개선**: `server/utils/result_formatter.py` 개선
  - `normalize_result()`: 표준 형식이 아닌 dict를 자동으로 `output` 필드로 래핑
  - `ensure_output_is_dict()`: output이 dict 형식인지 보장
  - 표준 필드(action, status, output, error, message, meta) 자동 처리
- **노드 설정 모달 개선**: 이전 노드 출력 변수를 태그 형태로 표시
  - 변수 선택 UI 개선
  - 변수 값 미리보기 기능
  - data와 metadata 분리 표시
- **워크플로우 로드 서비스**: 노드 데이터 로드 시 metadata 분리 처리
  - `metadata` 필드를 별도로 저장 및 관리
  - 표준 필드와 메타데이터 필드 자동 분리
- **대시보드 관련 함수 리팩토링**: `dashboard.js`로 관련 함수 이동 및 통합
- **CSS 파일 구조 개선**: 워크플로우 관련 CSS 파일을 `styles/pages/workflow/`로 이동
- **노드 설정 방식 변경**: 노드의 동적 설정값을 `nodes_config.py`의 `parameters` 필드로 중앙 관리
- **실행 ID 생성 방식 변경**: UUID 기반에서 날짜시간 기반 형식으로 변경 (`20240115-143025-a3f9b2`)
- **로그 페이지 통합**: 별도의 "로그" 페이지를 제거하고 "실행 기록" 페이지에 통합
- **실행 그룹 UI 개선**: 화살표 버튼 대신 헤더 전체 클릭으로 상세 정보 표시
- **노드 생성 모달**: 파라미터 정의에 따라 자동으로 입력 필드 생성
- **노드 설정 모달**: 파라미터 정의에 따라 자동으로 입력 필드 생성 및 기존 값 표시
- **action 노드 제거**: `nodes_config.py`에서 action 노드 제거, 관련 JavaScript 파일 및 DB 시드 데이터 제거
- **404 에러 처리 개선**: 사용자 설정이 없을 때 발생하는 404 에러를 조용히 처리 (정상 동작)
- **출력 미리보기 로직 개선**: 기본값을 예시 출력으로 설정하고, 특정 노드(`wait`, `start`, `end`)만 실제 실행 결과 표시
- **중앙 모달 시스템**: 확인/알림 모달을 중앙에 표시하는 기능 추가
  - `ModalManager`에 `showCenterConfirm()`, `showCenterAlert()` 메서드 추가
  - 사이드바 너비를 고려한 중앙 정렬 계산
  - ESC 키 및 배경 클릭으로 닫기 지원

### 제거됨
- **레거시 노드 파일**: `node-end.js`, `end.py` 제거
- **레거시 설정 파일**: `nodes.config.js` 제거
- **표현식 파서**: `expression_parser.py` 제거 (사용되지 않음)
- **미사용 노드 타입 제거**: `move`, `collect`, `battle`, `navigate` 노드 타입 및 관련 파일 제거
  - Python 파일: `server/nodes/actionnodes/move.py`, `collect.py`, `battle.py`, `navigate.py`
  - JavaScript 예시 출력 함수 제거
  - `action_service.py`, `workflow_engine.py`에서 관련 핸들러 제거

### 수정됨
- **노드 출력 형식 통일**: 모든 노드가 표준 형식 `{action, status, output: {...}}`을 따르도록 수정
- **이전 노드 출력 처리**: 이전 노드의 output을 올바르게 파싱하여 변수로 표시
- **대시보드 통계 계산**: 데이터베이스에서 실시간으로 통계 계산
- **스크립트 실행 기록**: 실행 결과를 데이터베이스에 저장하여 대시보드에 반영
- **대시보드 DB 초기값 설정**: `all_executions`, `all_failed_scripts` 초기값을 0으로 설정
  - 새 DB 생성 시 자동 초기화
  - 기존 DB 마이그레이션 시 초기값 추가
- **실행 기록 페이지 확인 팝업**: 웹 기본 `confirm()` 대신 커스텀 모달 사용
  - 개별 로그 삭제 확인 모달
  - 실행 그룹 삭제 확인 모달
  - 전체 로그 삭제 확인 모달
  - 라이트/다크 테마 지원
  - 에러 메시지도 `alert()` 대신 커스텀 모달 사용
- **로그 삭제 모달 중앙 배치**: 오른쪽 사이드바 모달에서 중앙 팝업 모달로 변경
  - `showCenterConfirm()`, `showCenterAlert()` 메서드 추가
  - 사이드바를 제외한 메인 콘텐츠 영역 중앙에 표시
  - 기존 `result-modal` 스타일 재사용으로 일관된 UI 제공
- `workflow-load-service.js`에서 `getNodeRegistry` 함수 호출 오류 수정
- `node-action.js` 파일 로드 시도로 인한 404 에러 제거
- 정의되지 않은 노드 타입이 UI에 표시되는 문제 해결
- **노드 실행 중복 방지**: `prepareWorkflowData`에서 노드가 중복으로 실행 목록에 추가되는 문제 수정
- **실패 노드 카운팅 오류**: `failCount`가 중복으로 증가하던 문제 수정 (에러 발생 시 한 번만 카운팅)
- **로그 통계 DB 저장**: 로그 삭제 시 통계가 즉시 반영되도록 DB 기반 통계 시스템 구현
  - `log_stats` 테이블 생성 및 초기화 (`total`, `completed`, `failed`, `average_execution_time`)
  - `LogStatsRepository` 클래스 생성 (통계 조회/업데이트 메서드)
  - 로그 생성 시 통계 업데이트 (completed/failed 상태일 때만, running 제외)
  - 로그 삭제 API에서 통계 계산 및 응답에 포함
  - 프론트엔드에서 서버 통계로 즉시 업데이트
  - 서버 최초 실행 시 기존 로그가 있으면 통계 자동 계산
  - **전체 로그 카운팅 방식 변경**: 노드 실행 로그 개수 대신 스크립트 실행 단위로 카운팅 (`execution_id` 기준 고유 개수)
- **실행 기록 페이지 실시간 업데이트**: 워크플로우 실행 완료 시 자동으로 로그 새로고침
  - `logsUpdated` CustomEvent를 통한 이벤트 기반 업데이트
  - 단일 스크립트 실행 완료 시 자동 새로고침
  - 단일 스크립트 실행 실패 시 자동 새로고침 (폴백 경로 포함)
  - 전체 스크립트 실행 완료 시 자동 새로고침
  - 실행 기록 페이지가 표시 중일 때만 업데이트 (성능 최적화)
  - 서버 로그 저장 완료를 위한 적절한 지연 시간 적용 (1초)
- **대시보드 어제 대비 표시 제거**: 통계 카드에서 "어제 대비 n%" 변화량 표시 제거
  - HTML에서 `stat-change` 요소 제거
  - JavaScript에서 변화량 계산 및 표시 로직 제거
  - Python에서 어제 실행 횟수 조회 및 변화율 계산 메서드 제거 (`_get_yesterday_executions_count`, `_calculate_executions_change_percent`)
  - CSS에서 `stat-change` 관련 스타일 제거
- **노드 실행 로그 업데이트 방식 변경**: 실행 중 로그를 생성하고, 완료 시 해당 로그를 업데이트
  - `running` 상태: 새 로그 생성
  - `completed`/`failed` 상태: 같은 `execution_id`와 `node_id`를 가진 `running` 로그를 찾아서 업데이트
  - 중복 로그 생성 방지 (이전: running + completed = 2개, 현재: running → completed = 1개)
  - 비동기 로그 전송으로 인한 타이밍 이슈 해결: running 로그를 찾지 못하면 최근 생성된 로그를 찾아서 업데이트
- **condition 노드 분기 처리 개선**: condition 노드 실행 후 결과에 따라 다음 노드를 동적으로 선택
  - True 경로: `output.result === true`인 경우 `outputType='true'` 연결만 실행
  - False 경로: `output.result === false`인 경우 `outputType='false'` 연결만 실행
  - 실행되지 않은 경로의 노드들은 실행 목록에서 제거하여 로그 생성 방지
  - False 경로 노드에 대한 running 로그 생성 문제 해결
