# 노드 기반 워크플로우 편집기 설계

## 문제 상황

자동화 스크립트를 작성하기 위해서는 복잡한 로직을 시각적으로 표현하고 편집할 수 있는 인터페이스가 필요했습니다. 기존의 텍스트 기반 스크립트 작성 방식은 다음과 같은 문제가 있었습니다:

1. **가독성 부족**: 복잡한 로직을 텍스트로만 표현하면 이해하기 어려움
2. **시각적 흐름 파악 어려움**: 조건문, 반복문 등의 흐름을 시각적으로 확인 불가
3. **편집 어려움**: 노드 간 연결 관계를 텍스트로 관리하기 복잡
4. **재사용성 낮음**: 비슷한 로직을 복사/붙여넣기로만 재사용 가능

## 설계 결정

### 노드 기반 시각적 편집기 채택

**이유:**
- **직관성**: 각 작업을 노드로 표현하여 시각적으로 이해하기 쉬움
- **확장성**: 새로운 노드 타입을 쉽게 추가 가능
- **재사용성**: 노드를 조합하여 다양한 워크플로우 생성 가능
- **검증 용이성**: 노드 간 연결을 시각적으로 확인하여 로직 오류 방지

### Figma 스타일 캔버스 구현

**구현 방식:**
```css
/* 무한 캔버스 구현 */
.canvas-content {
    position: absolute;
    width: 100000px;   /* 무한 캔버스 */
    height: 100000px;  /* 무한 캔버스 */
    transform-origin: 0 0;
}

.workflow-canvas {
    position: absolute;
    cursor: grab;  /* 드래그 가능한 커서 */
    overflow: hidden;
}
```

**이유:**
1. **무한 확장성**: 복잡한 워크플로우도 제약 없이 표현 가능
2. **자유로운 배치**: 노드를 원하는 위치에 자유롭게 배치
3. **사용자 친화적**: Figma와 유사한 인터페이스로 학습 곡선 낮음

### 패닝(Panning) 및 줌(Zoom) 기능

**구현:**
- **패닝**: 마우스 휠 버튼 드래그로 화면 이동
- **줌**: Ctrl + 마우스 휠로 확대/축소
- **키보드 단축키**: 화살표 키로 패닝, +/- 키로 줌

**이유:**
1. **큰 워크플로우 탐색**: 복잡한 워크플로우에서도 쉽게 탐색 가능
2. **정밀한 편집**: 줌을 통해 노드의 세부 설정을 정확하게 편집
3. **전체 보기**: 줌 아웃으로 전체 워크플로우 구조 파악

### 노드 아이콘 시스템

**아이콘 체계:**
- 노드 아이콘은 `node-icons.config.js`에서 중앙 관리
- 각 노드 타입별 고유 아이콘 사용
- 아이콘은 왼쪽 색상 박스에 표시

**이유:**
1. **빠른 인식**: 아이콘으로 노드 타입을 즉시 구분 가능
2. **일관성**: 모든 노드가 동일한 레이아웃 사용
3. **확장성**: 새로운 노드 추가 시 아이콘만 추가하면 됨

## 기술적 구현

### Transform 기반 위치 관리

**이유:**
- **성능**: CSS Transform은 GPU 가속을 받아 부드러운 애니메이션 가능
- **정확성**: 픽셀 단위 정확한 위치 제어
- **부드러움**: 리플로우 없이 위치 변경 가능

```javascript
// 노드 위치 업데이트
node.style.transform = `translate(${x}px, ${y}px)`;
```

### 연결선(Connection) 시스템

**구현:**
- 노드의 입력/출력 포인트 간 연결
- SVG를 사용한 부드러운 곡선 그리기
- 드래그 중 실시간 연결선 업데이트

**이유:**
1. **시각적 흐름**: 노드 간 실행 순서를 명확히 표현
2. **검증**: 연결되지 않은 노드나 잘못된 연결을 쉽게 발견
3. **직관성**: 데이터 흐름을 시각적으로 표현

### 격자 배경 패턴

```css
background-image: 
    radial-gradient(circle at 1px 1px, rgba(255,255,255,0.1) 1px, transparent 0);
background-size: 20px 20px;
```

**이유:**
1. **정렬 가이드**: 노드를 격자에 맞춰 정렬하기 쉬움
2. **공간감**: 캔버스의 크기와 위치를 직관적으로 파악
3. **전문성**: 전문적인 디자인 도구의 느낌

## 사용자 경험 개선

### 드래그 앤 드롭

- **노드 드래그**: 마우스로 노드를 자유롭게 이동
- **연결 드래그**: 출력 포인트에서 입력 포인트로 드래그하여 연결
- **스크립트 순서 변경**: 사이드바에서 드래그하여 실행 순서 변경

### 컨텍스트 메뉴

- **노드 우클릭**: 노드 설정, 삭제, 복사 등 빠른 액션
- **캔버스 우클릭**: 새 노드 추가, 붙여넣기 등

### 키보드 단축키

- **Delete**: 선택된 노드 삭제
- **Ctrl+C/V**: 노드 복사/붙여넣기
- **Ctrl+Z/Y**: 실행 취소/다시 실행

## 결과

### 장점

1. **직관적인 인터페이스**: 비개발자도 쉽게 워크플로우 작성 가능
2. **시각적 검증**: 로직 오류를 시각적으로 쉽게 발견
3. **확장성**: 새로운 노드 타입 추가가 용이
4. **재사용성**: 노드를 조합하여 다양한 워크플로우 생성

### 사용자 피드백

- "코드 없이도 복잡한 자동화 스크립트를 만들 수 있어요"
- "노드 간 연결을 보면 실행 순서가 명확해요"
- "Figma처럼 사용할 수 있어서 익숙해요"

## 향후 개선 방향

1. **노드 그룹화**: 여러 노드를 그룹으로 묶어 관리
2. **미니맵**: 전체 워크플로우를 작은 맵으로 표시
3. **자동 정렬**: 노드를 자동으로 정렬하는 기능
4. **템플릿**: 자주 사용하는 워크플로우를 템플릿으로 저장

