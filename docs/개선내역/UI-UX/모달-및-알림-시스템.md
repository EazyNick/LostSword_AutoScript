# 모달 및 알림 시스템 설계

## 문제 상황

사용자에게 정보를 전달하거나 입력을 받기 위한 인터페이스가 필요했습니다. 초기에는 다음과 같은 문제가 있었습니다:

1. **일관성 부족**: 각 기능마다 다른 방식으로 알림 표시
2. **사용자 경험 부족**: 모달 닫기, ESC 키 지원 등 기본 기능 부재
3. **시각적 피드백 부족**: 성공/실패 등의 상태를 명확히 표시하지 못함
4. **접근성 문제**: 키보드만으로도 모든 기능 사용 불가

## 설계 결정

### 모달 시스템 (Modal)

**용도:**
- 노드 추가/설정
- 확인 다이얼로그
- 폼 입력

**특징:**
- 배경 어둡게 처리 (backdrop)
- 메인 컨텐츠 영역 기준 중앙 정렬 (사이드바 제외)
- ESC 키로 닫기
- 배경 클릭으로 닫기
- 사이드바 너비 변경 시 자동 위치 조정

**이유:**
1. **집중도 향상**: 배경을 어둡게 하여 모달에 집중
2. **일관성**: 모든 모달이 동일한 방식으로 동작
3. **접근성**: 키보드로도 쉽게 닫을 수 있음

### Toast 알림 시스템

**용도:**
- 성공/실패 메시지
- 간단한 정보 전달
- 작업 완료 알림

**특징:**
- 메인 컨텐츠 영역 상단 중앙에 표시 (사이드바 제외)
- 자동으로 사라짐 (3초)
- 여러 Toast가 쌓여서 표시
- 타입별 색상 구분
- 사이드바 너비 변경 시 자동 위치 조정

**이유:**
1. **비침습적**: 사용자의 작업을 방해하지 않음
2. **시각적 피드백**: 작업 결과를 즉시 확인 가능
3. **일시적**: 중요한 정보가 아니므로 자동으로 사라짐

## 기술적 구현

### 모달 시스템

**구조:**
```html
<div id="modal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <div id="modal-body"></div>
    </div>
</div>
```

**애니메이션:**
```css
.modal.show {
    opacity: 1;
    animation: fadeIn 0.3s ease;
}

.modal.hide {
    opacity: 0;
    animation: fadeOut 0.3s ease;
}
```

**이유:**
1. **부드러운 전환**: 갑작스러운 나타남/사라짐 방지
2. **전문성**: 세련된 애니메이션으로 사용자 경험 향상
3. **성능**: CSS 애니메이션으로 GPU 가속 활용

### Toast 시스템

**구현:**
```javascript
show(message, type = 'success', duration = 3000) {
    const toast = document.createElement('div');
    toast.className = `toast toast-${type}`;
    // 애니메이션 적용
    toast.style.opacity = '0';
    toast.style.transform = 'translateY(-20px)';
    
    // 표시
    requestAnimationFrame(() => {
        toast.style.opacity = '1';
        toast.style.transform = 'translateY(0)';
    });
}
```

**타입별 색상:**
- **성공** (success): 초록색 (#10b981)
- **에러** (error): 빨간색 (#ef4444)
- **경고** (warning): 주황색 (#f59e0b)
- **정보** (info): 파란색 (#3b82f6)

**이유:**
1. **직관성**: 색상으로 메시지 타입을 즉시 파악
2. **일관성**: 모든 Toast가 동일한 스타일 사용
3. **접근성**: 색상뿐만 아니라 아이콘도 추가 가능

### 포커스 관리

**구현:**
```javascript
show(content) {
    // 모달 표시
    this.modal.style.display = 'block';
    
    // 첫 번째 입력 필드에 포커스
    const firstInput = this.modalBody.querySelector('input, select, textarea');
    if (firstInput) {
        setTimeout(() => firstInput.focus(), 100);
    }
}
```

**이유:**
1. **접근성**: 키보드 사용자가 즉시 입력 가능
2. **사용성**: 마우스 없이도 모달 사용 가능
3. **효율성**: 자동 포커스로 입력 시간 단축

## 사용자 경험 개선

### 모달 닫기 방법

1. **X 버튼 클릭**: 우측 상단의 X 버튼
2. **ESC 키**: 키보드 ESC 키
3. **배경 클릭**: 모달 외부 영역 클릭

**이유:**
- 다양한 방법 제공으로 사용자 편의성 향상
- 직관적인 인터랙션

### Toast 스택 관리

**구현:**
- 여러 Toast가 동시에 표시될 수 있음
- 위에서 아래로 쌓여서 표시
- 각 Toast는 독립적으로 사라짐

**이유:**
1. **정보 손실 방지**: 여러 작업의 결과를 모두 확인 가능
2. **비침습적**: 사용자가 원할 때만 확인
3. **효율성**: 여러 알림을 한 번에 처리

### 애니메이션 타이밍

**모달:**
- 나타남: 0.3초 fadeIn
- 사라짐: 0.3초 fadeOut

**Toast:**
- 나타남: 0.3초 slideDown
- 사라짐: 0.3초 slideUp

**이유:**
1. **자연스러움**: 너무 빠르거나 느리지 않은 적절한 속도
2. **인지 가능**: 사용자가 변화를 인지할 수 있는 속도
3. **성능**: 60fps 유지 가능한 속도

## 결과

### 장점

1. **일관된 사용자 경험**: 모든 모달과 Toast가 동일한 방식으로 동작
2. **명확한 피드백**: 작업 결과를 즉시 확인 가능
3. **접근성**: 키보드만으로도 모든 기능 사용 가능
4. **전문성**: 세련된 애니메이션과 디자인

### 사용자 피드백

- "모달이 부드럽게 나타나서 좋아요"
- "Toast 알림이 자동으로 사라져서 편해요"
- "ESC 키로 모달을 닫을 수 있어서 편리해요"

## 최근 개선사항

### 메인 컨텐츠 영역 기준 중앙 정렬
- 모달과 Toast가 사이드바를 제외한 메인 컨텐츠 영역 기준으로 중앙 정렬됨
- 사이드바 너비 변경 시 자동으로 위치가 조정됨
- CSS 변수(`--sidebar-width`)를 사용하여 동적 위치 계산

**이유:**
1. **시각적 균형**: 사이드바를 제외한 실제 작업 영역 기준으로 중앙 정렬
2. **반응형**: 사이드바 크기 변경에 자동 대응
3. **일관성**: 모든 팝업이 동일한 기준으로 배치

## 향후 개선 방향

1. **모달 크기 조절**: 사용자가 모달 크기를 조절 가능
2. **Toast 위치 설정**: 사용자가 Toast 표시 위치 선택
3. **알림 히스토리**: 최근 알림 목록 확인 기능
4. **음성 알림**: 중요한 알림에 음성 추가

