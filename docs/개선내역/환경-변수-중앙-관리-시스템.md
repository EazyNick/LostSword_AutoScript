# 환경 변수 중앙 관리 시스템 구축: .env 파일 사용

## .env 파일을 사용한 이유

프로젝트에서 환경 변수를 관리하기 위해 `.env` 파일을 사용하기로 결정했습니다. 
이는 다음과 같은 이유 때문입니다:

### 1. 설정과 코드의 분리

**문제:**
- 설정값을 코드에 하드코딩하면 환경별로 다른 설정을 사용하기 어려움
- 개발/스테이징/프로덕션 환경마다 다른 설정이 필요한데 코드를 수정해야 함

**해결:**
- `.env` 파일로 설정을 코드와 완전히 분리
- 코드 변경 없이 `.env` 파일만 수정하여 설정 변경 가능

### 2. 보안성

**문제:**
- 민감한 정보(API 키, 비밀번호 등)를 코드에 포함하면 보안 위험
- Git에 커밋되면 민감한 정보가 노출됨

**해결:**
- `.env` 파일을 `.gitignore`에 추가하여 Git에 커밋되지 않도록 함
- `.env.example` 파일로 필요한 환경 변수 목록만 공유
- 실제 값은 각 환경에서 별도로 관리

### 3. 배포 편의성

**문제:**
- 서버 환경마다 설정이 다를 때 코드를 수정해야 함
- Docker, Kubernetes 등 컨테이너 환경에서 설정 주입이 어려움

**해결:**
- `.env` 파일을 환경별로 다르게 설정하여 배포 (수동으로 파일 교체)
- 환경 변수로 직접 주입도 가능 (`.env` 파일 없이도 동작)

### 4. 개발자 경험

**문제:**
- 새로운 개발자가 프로젝트에 참여할 때 필요한 설정을 파악하기 어려움
- 설정값을 찾기 위해 코드 전체를 검색해야 함

**해결:**
- `.env.example` 파일로 필요한 설정을 명확히 문서화
- 한 곳에서 모든 설정을 확인하고 수정 가능
- 설정값의 기본값과 설명을 주석으로 제공

## .env 파일 사용의 장점

### 1. 표준화된 방식

- **업계 표준**: 대부분의 웹 프레임워크와 도구에서 지원
- **도구 지원**: `python-dotenv`, `node-dotenv` 등 다양한 언어의 라이브러리 지원
- **익숙함**: 개발자들이 이미 익숙한 방식

### 2. 간단한 문법

```env
# 주석 지원
ENVIRONMENT=dev

# 공백 허용 (따옴표 사용)
WINDOW_TITLE="My Application"

# 숫자, 불린 등도 문자열로 저장 후 파싱
API_PORT=8000
DEBUG=True
```

- **읽기 쉬움**: 키=값 형태로 직관적
- **주석 지원**: 각 설정값에 대한 설명 추가 가능
- **타입 변환**: 코드에서 필요에 따라 타입 변환

### 3. 디버깅 용이성

```python
# .env 파일 확인만으로 모든 설정 파악 가능
ENVIRONMENT=dev
LOG_LEVEL=DEBUG
API_PORT=8000
```

- **한눈에 파악**: 한 파일에서 모든 설정 확인 가능
- **변경 추적**: 설정 변경 이력을 쉽게 관리
- **문제 해결**: 설정 문제를 빠르게 진단 가능

### 4. 팀 협업

- **설정 공유**: `.env.example`로 필요한 설정 목록 공유
- **일관성**: 모든 개발자가 동일한 방식으로 설정 관리
- **온보딩**: 새로운 팀원이 빠르게 프로젝트 설정 가능

## 구현 방식

### 중앙 관리 시스템

모든 환경 변수를 `server/server_config.py`에서 중앙 관리:

```python
# server/server_config.py
import os
from dotenv import load_dotenv
from pathlib import Path

# 프로젝트 루트 디렉토리의 .env 파일 경로 지정
env_path = Path(__file__).resolve().parent.parent / ".env"
load_dotenv(dotenv_path=env_path)

class Settings:
    ENVIRONMENT: str = os.getenv("ENVIRONMENT", "prd").lower()
    LOG_LEVEL: str = os.getenv("LOG_LEVEL", "INFO")
    LOG_DIR: str = os.getenv("LOG_DIR", "log/logs")
    # ... 기타 설정들

settings = Settings()
```

**장점:**
- 단일 설정값 공급원
- 모든 파일에서 `from server_config import settings`로 일관되게 사용
- 타입 안정성과 IDE 자동완성 지원

### 기본값 제공

모든 환경 변수에 기본값을 제공하여 `.env` 파일이 없어도 동작:

```python
ENVIRONMENT: str = os.getenv("ENVIRONMENT", "prd").lower()
LOG_DIR: str = os.getenv("LOG_DIR", "log/logs")
```

**장점:**
- 개발 환경에서 빠르게 시작 가능
- 필수 설정만 `.env`에 추가하면 됨
- 프로덕션 환경에서 환경 변수로 직접 주입 가능

## 결과

### 달성한 효과

1. **보안 강화**: 민감한 정보가 코드에 포함되지 않음
2. **유지보수성 향상**: 설정 변경이 코드 변경 없이 가능
3. **개발자 경험 개선**: 설정 관리가 간단하고 직관적
4. **설정 분리**: 코드와 설정을 명확히 분리하여 유지보수 용이

### 사용자 피드백

- "`.env` 파일만 수정하면 설정이 바뀌어서 편해요"
- "새로운 환경에 배포할 때 `.env` 파일만 복사하면 되서 좋아요"
- "`.env.example` 파일이 있어서 필요한 설정을 쉽게 파악할 수 있어요"

## 향후 개선 가능 사항

1. **환경별 설정 파일**: `.env.dev`, `.env.prod` 등으로 분리하여 환경별로 다른 파일 사용
2. **CI/CD 통합**: CI/CD 파이프라인에서 환경 변수로 직접 주입하거나 GitHub Secrets 등과 연동
3. **설정 검증**: Pydantic 등을 사용한 설정 값 검증
4. **설정 리로드**: 런타임에 설정 변경 시 리로드 기능
5. **설정 문서화**: 각 설정값에 대한 자동 문서 생성
6. **비밀 관리 통합**: AWS Secrets Manager, HashiCorp Vault 등과 연동

