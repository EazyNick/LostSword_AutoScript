# 다국어 지원 (i18n) 시스템

## 개요

애플리케이션은 한국어와 영어를 지원하는 완전한 다국어 시스템을 구현하고 있습니다. 모든 UI 요소가 언어 설정에 따라 자동으로 번역되어 표시됩니다.

## 아키텍처

### 중앙화된 번역 시스템

번역 시스템은 `UI/src/js/utils/i18n.js`에 중앙화되어 있습니다.

```javascript
import { t, setLanguage, getLanguage } from '../../js/utils/i18n.js';

// 번역 키로 텍스트 가져오기
const text = t('common.save'); // '저장' 또는 'Save'

// 언어 변경
await setLanguage('en'); // 영어로 변경

// 현재 언어 가져오기
const currentLang = getLanguage(); // 'ko' 또는 'en'
```

### 번역 키 구조

번역 키는 계층적 구조를 따릅니다:

- `common.*`: 공통 UI 요소 (확인, 취소, 저장 등)
- `settings.*`: 설정 페이지 항목
- `sidebar.*`: 사이드바 메뉴
- `header.*`: 페이지 헤더
- `history.*`: 실행 기록 페이지
- `dashboard.*`: 대시보드 페이지

### 언어 설정 저장

언어 설정은 다음 두 곳에 저장됩니다:

1. **로컬 스토리지**: 즉시 적용을 위한 클라이언트 측 저장
2. **데이터베이스**: 서버 측 저장으로 재시작 후에도 유지

## 사용 방법

### 기본 사용법

```javascript
import { t } from '../../js/utils/i18n.js';

// 번역 키로 텍스트 가져오기
const saveText = t('common.save');
const cancelText = t('common.cancel');
```

### 파라미터가 있는 번역

일부 번역 키는 파라미터를 받습니다:

```javascript
// 예: "5분 전"
const timeText = t('history.minutesAgo', { minutes: 5 });
```

### 언어 변경

```javascript
import { setLanguage } from '../../js/utils/i18n.js';

// 언어 변경 (이벤트 발생)
await setLanguage('en');

// 언어 변경 (이벤트 발생 안 함, 초기 로드 시 사용)
await setLanguage('ko', true);
```

## 언어 변경 이벤트

언어가 변경되면 `languageChanged` 커스텀 이벤트가 발생합니다:

```javascript
document.addEventListener('languageChanged', async (event) => {
    const language = event.detail.language;
    // UI 업데이트 로직
    updateUI(language);
});
```

## 페이지별 번역 적용

### 정적 텍스트 업데이트

각 페이지 매니저는 `updateStaticTexts()` 메서드를 구현하여 HTML의 정적 텍스트를 업데이트합니다:

```javascript
updateStaticTexts() {
    const title = document.querySelector('.page-title');
    if (title) {
        title.textContent = t('header.dashboard');
    }
}
```

### 동적 텍스트 번역

동적으로 생성되는 텍스트는 `t()` 함수를 직접 사용합니다:

```javascript
renderLogs() {
    const message = t('history.noLogs');
    // ...
}
```

## CSS 변수를 통한 번역

CSS의 `content` 속성에 하드코딩된 텍스트는 CSS 변수를 사용합니다:

```css
.script-card.executing .btn-run .btn-run-text::after {
    content: var(--running-text, ' 실행 중...');
}
```

JavaScript에서 CSS 변수를 업데이트:

```javascript
updateRunningTextCSS() {
    const runningText = ` ${t('common.running')}...`;
    document.documentElement.style.setProperty('--running-text', `'${runningText}'`);
}
```

## 번역 키 추가 방법

### 1. `i18n.js`에 번역 키 추가

```javascript
const translations = {
    ko: {
        common: {
            newKey: '새로운 텍스트'
        }
    },
    en: {
        common: {
            newKey: 'New Text'
        }
    }
};
```

### 2. 코드에서 사용

```javascript
const text = t('common.newKey');
```

## 지원 언어

현재 지원하는 언어:

- **한국어 (ko)**: 기본 언어
- **영어 (en)**: 완전 번역 지원

새로운 언어를 추가하는 방법은 [Adding New Languages](./adding-languages.md) 문서를 참고하세요.

## 모달 및 팝업 번역

모든 모달과 팝업도 번역 시스템을 사용합니다:

- **중앙 알림 모달**: `ModalManager.showCenterAlert()`
- **중앙 확인 모달**: `ModalManager.showCenterConfirm()`
- **실행 결과 모달**: `ResultModalManager.showExecutionResult()`

## 주의사항

1. **번역 키는 항상 문자열로 반환**: 번역 키를 찾지 못하면 키 자체가 반환됩니다
2. **HTML 이스케이프**: 동적으로 생성되는 HTML에 번역 텍스트를 삽입할 때는 `escapeHtml()` 함수 사용
3. **초기 로드**: 페이지 초기 로드 시 `setLanguage(language, true)`를 사용하여 불필요한 이벤트 발생 방지

## 관련 파일

- `UI/src/js/utils/i18n.js`: 번역 시스템 핵심 모듈
- `UI/src/pages/workflow/page-router.js`: 언어 변경 이벤트 처리
- `UI/src/pages/workflow/settings.js`: 언어 설정 UI
- `UI/src/pages/workflow/dashboard.js`: 대시보드 번역
- `UI/src/pages/workflow/history.js`: 실행 기록 번역
- `UI/src/js/utils/result-modal.js`: 실행 결과 모달 번역
- `UI/src/js/utils/modal.js`: 일반 모달 번역
