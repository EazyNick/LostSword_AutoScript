**최신 수정일자: 2025.12.21**

# 노드 목록

AutoScript에서 사용 가능한 모든 노드 타입을 설명합니다.

## 경계 노드 (Boundary Nodes)

### 시작 노드 (Start)
- **설명**: 워크플로우의 시작점을 나타내는 노드
- **용도**: 워크플로우 실행 시 가장 먼저 실행되는 노드

## 프로세스 노드 (Process Nodes)

### 프로세스 포커스 노드 (Process Focus)
- **설명**: 선택한 프로세스의 창을 화면 최상단에 포커스하는 노드
- **용도**: 특정 애플리케이션 창을 활성화

## 대기 노드 (Wait Nodes)

### 대기 노드 (Wait)
- **설명**: 지정된 시간만큼 대기하는 노드
- **용도**: 워크플로우 실행 중 일정 시간 대기
- **파라미터**:
  - `wait_time`: 대기 시간 (초 단위)

## 엑셀 노드 (Excel Nodes) - Windows 전용

### 엑셀 열기 노드 (Excel Open)
- **설명**: `win32com`을 사용하여 Microsoft Excel 파일을 여는 노드
- **용도**: 엑셀 파일을 열고 워크플로우 실행 중 객체 유지
- **주의사항**: Windows 환경에서만 사용 가능, `pywin32` 라이브러리 필요
- **파라미터**:
  - `file_path`: 열 엑셀 파일 경로 (필수)
  - `visible`: 엑셀 창 표시 여부 (기본값: True)
- **출력**:
  - `file_path`: 열린 엑셀 파일 경로
  - `visible`: 엑셀 창 표시 여부
  - `success`: 성공 여부
  - `execution_id`: 스크립트 실행 ID (다음 노드에서 사용)

### 엑셀 닫기 노드 (Excel Close)
- **설명**: 엑셀 열기 노드로 열린 엑셀 파일을 닫는 노드
- **용도**: 열려있는 엑셀 파일을 닫고 변경사항 저장 옵션 제공
- **주의사항**: Windows 환경에서만 사용 가능, `pywin32` 라이브러리 필요
- **파라미터**:
  - `execution_id`: 엑셀 실행 ID (이전 노드 출력에서 선택하거나 직접 입력, 기본값: `output.data.execution_id`)
  - `save_changes`: 변경사항 저장 여부 (기본값: True)
- **출력**:
  - `success`: 성공 여부
  - `save_changes`: 변경사항 저장 여부

## 이미지 노드 (Image Nodes)

### 이미지 터치 노드 (Image Touch)
- **설명**: 화면에서 이미지를 찾아 터치하는 노드
- **용도**: 화면 캡처를 통해 특정 이미지를 찾아 클릭
- **특징**: 이미지 파일 경로 설정 필요

## 로직 노드 (Logic Nodes)

### 조건 노드 (Condition)
- **설명**: 조건을 확인하고 결과를 반환하는 노드
- **용도**: 조건에 따라 워크플로우 분기 처리

### 반복 노드 (Repeat)
- **설명**: 지정한 횟수만큼 노드 블록을 반복 실행하는 노드
- **용도**: 동일한 작업을 여러 번 반복 실행해야 할 때 사용
- **파라미터**:
  - `repeat_count`: 반복할 횟수 (1~10000, 기본값: 1)
- **연결점**:
  - **입력 연결점** (왼쪽): 이전 노드에서 실행 흐름을 받음
  - **반복 연결점** (아래): 반복할 노드들을 연결하는 특별한 연결점
  - **출력 연결점** (오른쪽): 반복 완료 후 실행할 노드를 연결
- **동작 방식**:
  1. 반복 노드가 실행되면 설정한 반복 횟수를 확인
  2. 아래 연결점에 연결된 노드들을 순차적으로 실행
  3. 모든 노드 실행이 완료되면 다시 처음부터 반복
  4. 설정한 횟수만큼 반복이 완료되면 오른쪽 출력 연결점에 연결된 노드로 진행
- **반복 블록 정의**:
  - 반복 연결점에 연결된 첫 번째 노드부터 시작하여 출력 연결을 따라가며 체인을 구성합니다
  - 끝 노드의 출력이 아무것도 연결되지 않으면 거기서 반복 블록이 종료됩니다
  - 반복 노드로 돌아가는 연결은 순환 방지를 위해 제외됩니다
  - 출력 연결점에 연결된 노드는 반복 블록에 포함되지 않으며, 반복 완료 후에만 실행됩니다
- **실행 아키텍처**:
  - **프론트엔드**: 각 반복마다 개별 API 요청을 보내어 실시간 UI 업데이트를 제공합니다
  - **서버**: `current_iteration`과 `total_iterations`를 받아 단일 반복만 실행합니다
  - **실행 ID**: 모든 반복이 같은 `execution_id`를 사용하여 하나의 실행으로 그룹화됩니다
  - **메타데이터**: 반복 블록 내 각 노드에 `repeat_info` 메타데이터가 추가됩니다
    - `is_repeat_start`: 반복 블록의 첫 번째 노드 여부
    - `is_repeat_end`: 반복 블록의 마지막 노드 여부
    - `current_iteration`: 현재 반복 번호 (1부터 시작)
    - `total_iterations`: 전체 반복 횟수
    - `node_index_in_repeat`: 반복 블록 내 노드 인덱스
    - `total_nodes_in_repeat`: 반복 블록 내 전체 노드 개수
- **UI 업데이트**:
  - 각 반복 시작 시 반복 노드가 실행 중 상태로 표시됩니다
  - 반복 블록 내 각 노드가 실행될 때마다 실시간으로 실행 중 상태가 표시됩니다
  - 각 반복 완료 시 반복 노드가 완료 상태로 표시되며, 다음 반복이 시작되면 다시 실행 중 상태로 변경됩니다
- **사용 예시**:
  ```
  시작 노드
    ↓
  반복 노드 (반복 횟수: 3)
    ↓ (반복 연결점)
  대기 노드 (1초)
    ↓
  클릭 노드
    ↓ (반복 완료 후)
  출력에 연결된 노드
  ```
  위 예시에서는 대기 노드와 클릭 노드가 3번 반복 실행된 후 출력에 연결된 노드가 실행됩니다.
- **주의사항**:
  - 반복 연결점과 출력 연결점은 독립적으로 관리되므로 서로 영향을 주지 않습니다
  - 반복 연결점에 연결된 노드들은 순차적으로 실행되며, 마지막 노드에서 다시 처음 노드로 돌아갑니다
  - 반복 횟수는 1 이상의 정수여야 합니다
  - 반복 블록 내 노드들은 각 반복마다 동일한 순서로 실행됩니다
  - 출력 연결점에 연결된 노드는 반복 블록에 포함되지 않으므로 반복되지 않습니다
- **출력**:
  - `repeat_count`: 설정된 반복 횟수
  - `completed`: 반복 완료 여부 (항상 True)
  - `iterations`: 각 반복의 실행 결과 배열 (실제 반복 결과는 워크플로우 실행 엔진에서 채워짐)

## 노드 카테고리

- **시스템 노드**: 시작 노드
- **프로세스 노드**: 프로세스 포커스
- **대기 노드**: 대기
- **로직 노드**: 조건 분기, 반복
- **이미지 노드**: 이미지 인식 및 터치
- **엑셀 노드**: 엑셀 파일 열기/닫기

## 참고

- 새로운 노드를 추가하려면 [노드 추가 가이드](dev/nodes/creating-nodes.md)를 참고하세요.
- 각 노드의 상세 설정은 워크플로우 편집기에서 노드를 더블클릭하여 확인할 수 있습니다.

